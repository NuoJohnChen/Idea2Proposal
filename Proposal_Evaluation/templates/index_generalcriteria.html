<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Research Proposal Evaluator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .header-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
        }
        .metric-card {
            border: 1px solid #e3e6f0;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .metric-score {
            font-size: 2rem;
            font-weight: bold;
            color: #5a5c69;
        }
        .metric-description {
            font-size: 0.9rem;
            color: #6c757d;
            margin-top: 0.5rem;
        }
        .criteria-explanation {
            background: #f8f9fc;
            border-left: 4px solid #4e73df;
            padding: 1rem;
            margin-top: 1rem;
            border-radius: 0 5px 5px 0;
        }
        .score-scale {
            background: #fff;
            border: 1px solid #e3e6f0;
            border-radius: 5px;
            padding: 0.5rem;
            margin: 0.25rem 0;
        }
        .loading-spinner {
            display: none;
        }
        .result-section {
            display: none;
        }
        .proposal-input {
            min-height: 300px;
            border: 2px solid #e3e6f0;
            border-radius: 10px;
            padding: 1rem;
        }
        .btn-evaluate {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            color: white;
            padding: 0.75rem 2rem;
            border-radius: 25px;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .btn-evaluate:hover {
            background: linear-gradient(45deg, #5a6fd8, #6a4190);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .decision-accept {
            color: #28a745;
            font-weight: bold;
        }
        .decision-reject {
            color: #dc3545;
            font-weight: bold;
        }
        .other-fields {
            background: #f8f9fc;
            border-radius: 10px;
            padding: 1.5rem;
            margin-top: 2rem;
        }
        .field-item {
            margin-bottom: 1rem;
            padding: 1rem;
            background: white;
            border-radius: 5px;
            border-left: 4px solid #4e73df;
        }
    </style>
</head>
<body>
    <div class="header-section">
        <div class="container">
            <div class="row">
                <div class="col-12 text-center">
                    <h1><i class="fas fa-clipboard-check"></i> Research Proposal Evaluator</h1>
                    <p class="lead">Automated evaluation of research proposals using AI-powered analysis</p>
                    <div class="description-section mt-4">
                        <p class="mb-3">This demo primarily evaluates research proposals written after brainstorming with collaborators, mainly focusing on reflecting the value of ideas rather than writing.</p>
                        <div class="format-info">
                            <h5 class="text-white-50 mb-3">Research Proposal Format:</h5>
                            <p class="mb-2">The proposal is suggested to include:</p>
                            <ul class="list-unstyled text-start d-inline-block">
                                <li>• Title</li>
                                <li>• Problem Statement</li>
                                <li>• Motivation & Hypothesis</li>
                                <li>• Proposed Method</li>
                                <li>• Step-by-Step Experiment Plan</li>
                            </ul>
                        </div>
                        <div class="links-section mt-3">
                            <span class="me-3">
                                <strong>Proposal Example:</strong> 
                                <a href="#" class="text-white" style="text-decoration: underline;" data-bs-toggle="modal" data-bs-target="#exampleModal">
                                    {click for example}
                                </a>
                            </span>
                            <span>
                                <strong>Detailed Criteria:</strong> 
                                <a href="#" class="text-white" style="text-decoration: underline;" data-bs-toggle="modal" data-bs-target="#criteriaModal">
                                    {click for criteria}
                                </a>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container mt-4">
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <h3 class="card-title"><i class="fas fa-edit"></i> Submit Your Research Proposal</h3>
                        <p class="card-text">Please paste your research proposal text below and click "Evaluate" to get a comprehensive assessment.</p>
                        
                        <div class="form-group">
                            <label for="proposalText"><strong>Research Proposal Text:</strong></label>
                            <textarea class="form-control proposal-input" id="proposalText" 
                                placeholder="Paste your research proposal here...

Example format:
Title: Your Research Title
Problem Statement: Description of the problem...
Motivation & Hypothesis: Your hypothesis...
Proposed Method: Your approach...
Step-by-Step Experiment Plan: Your experimental design..."></textarea>
                        </div>
                        
                        <div class="text-center mt-4">
                            <button class="btn btn-evaluate" id="evaluateBtn">
                                <i class="fas fa-rocket"></i> Evaluate Proposal
                            </button>
                        </div>
                        
                        <div class="loading-spinner text-center mt-4" id="loadingSpinner">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                            <p class="mt-2">Evaluating your proposal... This may take a few moments.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="result-section" id="resultSection">
            <div class="row mt-4">
                <div class="col-12">
                    <h2><i class="fas fa-chart-line"></i> Evaluation Results</h2>
                </div>
            </div>

            <!-- Key Metrics -->
            <div class="row" id="keyMetrics">
                <!-- Metrics will be populated by JavaScript -->
            </div>

            <!-- Other Fields -->
            <div class="other-fields" id="otherFields">
                <h3><i class="fas fa-list"></i> Additional Review Details</h3>
                <div id="otherFieldsContent">
                    <!-- Other fields will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Example Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel"><i class="fas fa-file-text"></i> Research Proposal Example</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="example-content" style="font-family: 'Courier New', monospace; background: #f8f9fa; padding: 1rem; border-radius: 5px; white-space: pre-line; max-height: 60vh; overflow-y: auto;">
1. Title:
Mamba: Exploring Linear-Time Sequence Modeling with Selective State Spaces

2. Problem Statement:
The Transformer architecture, while dominant, is fundamentally constrained by the quadratic complexity of its attention mechanism. This makes scaling to very long sequences computationally prohibitive. Current alternatives, such as linear attention or structured state space models (SSMs), achieve linear or near-linear scaling but have not yet matched Transformer performance, especially on information-dense and discrete data like natural language. There is a clear performance-efficiency gap that needs to be closed.

3. Motivation & Hypothesis:
We hypothesize that a key weakness of existing efficient models is their time-invariant nature. Their core recurrence or convolution operations are fixed regardless of the input, which prevents them from dynamically adapting to the content of the sequence. For example, they cannot easily "choose" to remember a specific token from the distant past while ignoring irrelevant information in between.

Our central idea is to introduce a selection mechanism into the SSM framework. We believe that by making the model's state-transition parameters a function of the input, the model could learn to selectively propagate or forget information along the sequence dimension. This content-aware reasoning could be the missing piece needed to bridge the performance gap with Transformers.

4. Proposed Method:
We propose to develop a new class of models, which we'll call Selective State Space Models. The plan is to tackle this in three parts:

(1) Designing the Selection Mechanism: Our primary approach will be to modify the standard SSM formulation ('A', 'B', 'C' parameters). We will make the 'A', 'B', and 'C' parameters input-dependent by deriving them from the input 'x' through small linear projections. This should give the model the flexibility to modulate its own dynamics at each timestep.

(2) Overcoming the Computational Hurdle: This input-dependency breaks the efficient convolution-based computation used by prior SSMs. A naive recurrent implementation would be far too slow due to memory bottlenecks. To solve this, we plan to design a hardware-aware parallel scan algorithm. The idea is to use kernel fusion to perform the expensive state expansion and recurrence within the GPU's fast SRAM, avoiding costly read/writes to main HBM. We'll also need to implement recomputation in the backward pass to keep memory usage viable for training large models.

(3) A Simplified Architecture (Mamba): We will integrate our new selective SSM layer into a simplified, homogenous neural network architecture. Instead of alternating between attention and MLP blocks like in a Transformer, we will try stacking a single, unified "Mamba" block that combines the SSM with gated activations. This could lead to a simpler and more elegant design.

5. Step-by-Step Experiment Plan:
1. Isolate and Validate the Selection Mechanism:
First, we need to test if our core hypothesis is sound. We will create synthetic tasks where LTI models are known to fail but where selectivity should, in theory, succeed.
• Selective Copying: Can our model learn to recall specific tokens while ignoring variable-length spans of "noise" tokens?
• Induction Heads: Can our model solve this task, which is thought to be critical for in-context learning in LLMs? We are particularly interested in testing if it can extrapolate to much longer sequences than it was trained on.

2. Assess Performance on Long-Context Modalities:
If the synthetic tasks show promise, we'll move to real-world data where long-range dependencies are key.
• Genomics & Audio: We will train models on DNA and audio waveform data, with sequence lengths up to one million. Our key metric will be whether model performance (e.g., perplexity, BPD) improves with longer context, which would be a strong signal that the selection mechanism is working as intended.

3. Challenge Transformers on Language Modeling:
This is the ultimate test. We will conduct a series of language modeling experiments on a standard dataset like The Pile.
• Scaling Laws: We'll train models at several scales (e.g., ∼100M to ∼1B+ parameters) and plot their performance (perplexity) against compute to directly compare their scaling efficiency to a strong Transformer baseline.
• Downstream Evaluation: We will subject our pretrained models to a suite of zero-shot downstream tasks to see if the pretraining gains translate to common sense reasoning abilities.

4. Quantify Efficiency Gains:
We need to rigorously prove our computational claims.
• We will benchmark the raw speed of our selective scan kernel against optimized attention (FlashAttention-2) and convolution implementations.
• We will measure the end-to-end inference throughput (tokens/sec) and compare it against a Transformer of a similar size to demonstrate the practical benefits of eliminating the KV cache.

5. Conduct Ablation Studies:
To understand what makes the model work, we'll dissect it.
• Which parameters ('A', 'B', 'C') are most critical to make selective?
• How does performance change as we increase the latent state dimension 'N'?
• How does our simplified Mamba architecture compare to more complex hybrid designs?
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" onclick="copyExample()">Copy to Input</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Criteria Modal -->
    <div class="modal fade" id="criteriaModal" tabindex="-1" aria-labelledby="criteriaModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="criteriaModalLabel"><i class="fas fa-star"></i> Detailed Evaluation Criteria</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="criteria-content" style="max-height: 70vh; overflow-y: auto;">
                        <h6><strong>Four Holistic Evaluation Metrics:</strong></h6>
                        
                        <div class="metric-section mb-4">
                            <h6 class="text-primary"><strong>1. Novelty (1-10)</strong></h6>
                            <p><strong>Definition:</strong> This metric assesses the degree to which the research proposal introduces an original idea that modifies existing paradigms in the field. It evaluates originality and paradigm relatedness.</p>
                            <div class="scoring-details">
                                <p><strong>Scoring Rubric:</strong></p>
                                <ul class="small">
                                    <li><strong>10:</strong> Field-Defining: Proposes a highly original and paradigm-modifying idea that could fundamentally reshape the field or create a new subfield.</li>
                                    <li><strong>9:</strong> Paradigm-Shifting: The idea is extremely rare and imaginative, challenging core paradigms with transformative potential.</li>
                                    <li><strong>8:</strong> Highly Original: The core insight is profoundly novel and paradigm-modifying, offering a surprising new perspective on a key problem.</li>
                                    <li><strong>7:</strong> Significant Novelty: Introduces a rare and ingenious approach that meaningfully modifies existing paradigms.</li>
                                    <li><strong>6:</strong> Clever: Presents a non-obvious, imaginative idea that partially modifies paradigms within the current framework.</li>
                                    <li><strong>5:</strong> Solid Originality: Offers meaningful novelty but leans more toward paradigm-preserving improvements.</li>
                                    <li><strong>4:</strong> Minimally Novel: Slightly original, with just enough rarity or ingenuity to qualify as non-derivative, but mostly paradigm-preserving.</li>
                                    <li><strong>3:</strong> Derivative: Mostly paradigm-preserving with minimal originality, resembling common approaches.</li>
                                    <li><strong>2:</strong> Trivial: Lacks rarity and ingenuity, feeling mundane and non-transformational.</li>
                                    <li><strong>1:</strong> Not Novel: Completely repeats existing paradigms without any original or modifying elements.</li>
                                </ul>
                            </div>
                        </div>

                        <div class="metric-section mb-4">
                            <h6 class="text-primary"><strong>2. Workability (1-10)</strong></h6>
                            <p><strong>Definition:</strong> This metric evaluates the feasibility of the proposed research plan, assessing whether it can be easily implemented without violating known constraints. It considers acceptability and implementability.</p>
                            <div class="scoring-details">
                                <p><strong>Scoring Rubric:</strong></p>
                                <ul class="small">
                                    <li><strong>10:</strong> Bulletproof: Extremely feasible, with all constraints addressed innovatively; acceptability and implementability are exemplary.</li>
                                    <li><strong>9:</strong> Expert-Level: Highly workable, identifying and resolving constraints with clever, efficient strategies showing deep knowledge.</li>
                                    <li><strong>8:</strong> Highly Credible: Key constraints are addressed with specific, acceptable, and implementable solutions.</li>
                                    <li><strong>7:</strong> Credible: Major feasibility issues are identified, with plausible paths to acceptability and implementation.</li>
                                    <li><strong>6:</strong> Plausible: Overall workable, but some constraints or implementation details are not fully explored.</li>
                                    <li><strong>5:</strong> Feasible but Vague: Macro-level feasibility is present, but acceptability or implementability lacks detail.</li>
                                    <li><strong>4:</strong> Minimally Feasible: Just barely implementable, acknowledging key constraints with minimal but adequate mitigation; acceptability is marginal.</li>
                                    <li><strong>3:</strong> Overly Optimistic: Acknowledges constraints but proposes simplistic or unproven paths to implementation.</li>
                                    <li><strong>2:</strong> Ignores Fatal Flaws: Obvious constraints are overlooked, making acceptability or implementability doubtful.</li>
                                    <li><strong>1:</strong> Pure Fantasy: Violates known constraints entirely, with no feasible path to implementation.</li>
                                </ul>
                            </div>
                        </div>

                        <div class="metric-section mb-4">
                            <h6 class="text-primary"><strong>3. Relevance (1-10)</strong></h6>
                            <p><strong>Definition:</strong> This metric assesses how well the proposal applies to the stated research problem and its potential effectiveness in solving it. It evaluates applicability and effectiveness.</p>
                            <div class="scoring-details">
                                <p><strong>Scoring Rubric:</strong></p>
                                <ul class="small">
                                    <li><strong>10:</strong> Exemplary: Perfectly applicable and highly effective, reshaping understanding of the problem with inevitable impact.</li>
                                    <li><strong>9:</strong> Outstanding: Seamlessly applicable to the problem, with strong evidence of effectiveness in solving it.</li>
                                    <li><strong>8:</strong> Highly Relevant: Tightly fits the problem and demonstrates clear, superior effectiveness.</li>
                                    <li><strong>7:</strong> Relevant: Clearly applies to the problem with logical expectation of effectiveness.</li>
                                    <li><strong>6:</strong> Applicable: Fits the problem basically, with plausible but not deeply convincing effectiveness.</li>
                                    <li><strong>5:</strong> Understandable: Core relevance is graspable, but applicability or effectiveness has gaps.</li>
                                    <li><strong>4:</strong> Minimally Relevant: Slightly applicable to the problem with just enough evidence of potential effectiveness to be considered on-topic.</li>
                                    <li><strong>3:</strong> Disconnected: Feels loosely applicable, with questionable effectiveness in addressing the problem.</li>
                                    <li><strong>2:</strong> Contradictory: Internal inconsistencies reduce applicability and effectiveness.</li>
                                    <li><strong>1:</strong> Irrelevant: Does not apply to the stated problem or offer any effective solution.</li>
                                </ul>
                            </div>
                        </div>

                        <div class="metric-section mb-4">
                            <h6 class="text-primary"><strong>4. Specificity (1-10)</strong></h6>
                            <p><strong>Definition:</strong> This metric evaluates how clearly and thoroughly the proposal is articulated, assessing whether it is worked out in detail. It considers implicational explicitness, completeness, and clarity.</p>
                            <div class="scoring-details">
                                <p><strong>Scoring Rubric:</strong></p>
                                <ul class="small">
                                    <li><strong>10:</strong> Gold Standard: Extremely specific, with explicit implications, full completeness, and flawless clarity; sets a benchmark.</li>
                                    <li><strong>9:</strong> Insightful: Highly detailed, with explicit causal links, comprehensive coverage, and clear communication.</li>
                                    <li><strong>8:</strong> Critical: Strong specificity, including detailed breakdowns and clear, complete articulation.</li>
                                    <li><strong>7:</strong> Rigorous: Thoroughly specified, with good explicitness, completeness, and clarity.</li>
                                    <li><strong>6:</strong> Sufficient: Basically specific, covering key details but with some vagueness in implications or completeness.</li>
                                    <li><strong>5:</strong> Basic: Core elements are specified, but lacks depth in explicitness, completeness, or clarity.</li>
                                    <li><strong>4:</strong> Minimally Specific: Just enough detail to convey the main ideas, with minimal explicitness, completeness, and clarity to be understandable.</li>
                                    <li><strong>3:</strong> Insufficient: Fails to detail key aspects, reducing explicitness and completeness.</li>
                                    <li><strong>2:</strong> Vague: Relies on ambiguous descriptions, lacking clarity and thoroughness.</li>
                                    <li><strong>1:</strong> Incoherent: Completely lacks specificity, with no clear details or explicit connections.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function copyExample() {
            const exampleText = `1. Title:
Mamba: Exploring Linear-Time Sequence Modeling with Selective State Spaces

2. Problem Statement:
The Transformer architecture, while dominant, is fundamentally constrained by the quadratic complexity of its attention mechanism. This makes scaling to very long sequences computationally prohibitive. Current alternatives, such as linear attention or structured state space models (SSMs), achieve linear or near-linear scaling but have not yet matched Transformer performance, especially on information-dense and discrete data like natural language. There is a clear performance-efficiency gap that needs to be closed.

3. Motivation & Hypothesis:
We hypothesize that a key weakness of existing efficient models is their time-invariant nature. Their core recurrence or convolution operations are fixed regardless of the input, which prevents them from dynamically adapting to the content of the sequence. For example, they cannot easily "choose" to remember a specific token from the distant past while ignoring irrelevant information in between.

Our central idea is to introduce a selection mechanism into the SSM framework. We believe that by making the model's state-transition parameters a function of the input, the model could learn to selectively propagate or forget information along the sequence dimension. This content-aware reasoning could be the missing piece needed to bridge the performance gap with Transformers.

4. Proposed Method:
We propose to develop a new class of models, which we'll call Selective State Space Models. The plan is to tackle this in three parts:

(1) Designing the Selection Mechanism: Our primary approach will be to modify the standard SSM formulation ('A', 'B', 'C' parameters). We will make the 'A', 'B', and 'C' parameters input-dependent by deriving them from the input 'x' through small linear projections. This should give the model the flexibility to modulate its own dynamics at each timestep.

(2) Overcoming the Computational Hurdle: This input-dependency breaks the efficient convolution-based computation used by prior SSMs. A naive recurrent implementation would be far too slow due to memory bottlenecks. To solve this, we plan to design a hardware-aware parallel scan algorithm. The idea is to use kernel fusion to perform the expensive state expansion and recurrence within the GPU's fast SRAM, avoiding costly read/writes to main HBM. We'll also need to implement recomputation in the backward pass to keep memory usage viable for training large models.

(3) A Simplified Architecture (Mamba): We will integrate our new selective SSM layer into a simplified, homogenous neural network architecture. Instead of alternating between attention and MLP blocks like in a Transformer, we will try stacking a single, unified "Mamba" block that combines the SSM with gated activations. This could lead to a simpler and more elegant design.

5. Step-by-Step Experiment Plan:
1. Isolate and Validate the Selection Mechanism:
First, we need to test if our core hypothesis is sound. We will create synthetic tasks where LTI models are known to fail but where selectivity should, in theory, succeed.
• Selective Copying: Can our model learn to recall specific tokens while ignoring variable-length spans of "noise" tokens?
• Induction Heads: Can our model solve this task, which is thought to be critical for in-context learning in LLMs? We are particularly interested in testing if it can extrapolate to much longer sequences than it was trained on.

2. Assess Performance on Long-Context Modalities:
If the synthetic tasks show promise, we'll move to real-world data where long-range dependencies are key.
• Genomics & Audio: We will train models on DNA and audio waveform data, with sequence lengths up to one million. Our key metric will be whether model performance (e.g., perplexity, BPD) improves with longer context, which would be a strong signal that the selection mechanism is working as intended.

3. Challenge Transformers on Language Modeling:
This is the ultimate test. We will conduct a series of language modeling experiments on a standard dataset like The Pile.
• Scaling Laws: We'll train models at several scales (e.g., ∼100M to ∼1B+ parameters) and plot their performance (perplexity) against compute to directly compare their scaling efficiency to a strong Transformer baseline.
• Downstream Evaluation: We will subject our pretrained models to a suite of zero-shot downstream tasks to see if the pretraining gains translate to common sense reasoning abilities.

4. Quantify Efficiency Gains:
We need to rigorously prove our computational claims.
• We will benchmark the raw speed of our selective scan kernel against optimized attention (FlashAttention-2) and convolution implementations.
• We will measure the end-to-end inference throughput (tokens/sec) and compare it against a Transformer of a similar size to demonstrate the practical benefits of eliminating the KV cache.

5. Conduct Ablation Studies:
To understand what makes the model work, we'll dissect it.
• Which parameters ('A', 'B', 'C') are most critical to make selective?
• How does performance change as we increase the latent state dimension 'N'?
• How does our simplified Mamba architecture compare to more complex hybrid designs?`;
            
            document.getElementById('proposalText').value = exampleText;
            bootstrap.Modal.getInstance(document.getElementById('exampleModal')).hide();
        }

        document.getElementById('evaluateBtn').addEventListener('click', function() {
            const proposalText = document.getElementById('proposalText').value.trim();
            
            if (!proposalText) {
                alert('Please enter a research proposal text.');
                return;
            }

            // Show loading spinner
            document.getElementById('loadingSpinner').style.display = 'block';
            document.getElementById('resultSection').style.display = 'none';
            this.disabled = true;

            // Make API call
            fetch('/evaluate', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    proposal_text: proposalText
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    displayResults(data.review, data.scoring_criteria);
                } else {
                    alert('Error: ' + data.error);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('An error occurred while evaluating the proposal.');
            })
            .finally(() => {
                // Hide loading spinner
                document.getElementById('loadingSpinner').style.display = 'none';
                document.getElementById('evaluateBtn').disabled = false;
            });
        });

        function displayResults(review, scoringCriteria) {
            // Display key metrics
            const keyMetrics = ['Overall_Quality', 'Novelty', 'Workability', 'Relevance', 'Specificity'];
            const keyMetricsContainer = document.getElementById('keyMetrics');
            keyMetricsContainer.innerHTML = '';

            keyMetrics.forEach(metric => {
                if (review[metric] !== undefined) {
                    const score = review[metric];
                    const criteria = scoringCriteria[metric];
                    
                    const metricCard = document.createElement('div');
                    metricCard.className = 'col-md-6 col-lg-4 mb-4';
                    metricCard.innerHTML = `
                        <div class="metric-card">
                            <div class="d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">${criteria.name}</h5>
                                <span class="metric-score">${score}/10</span>
                            </div>
                            <div class="metric-description">
                                ${criteria.description}
                            </div>
                            <div class="criteria-explanation">
                                <strong>Score ${score}:</strong> ${criteria.scale[score] || 'N/A'}
                            </div>
                        </div>
                    `;
                    keyMetricsContainer.appendChild(metricCard);
                }
            });

            // Display other fields
            const otherFieldsContainer = document.getElementById('otherFieldsContent');
            otherFieldsContainer.innerHTML = '';

            Object.keys(review).forEach(key => {
                if (!keyMetrics.includes(key) && !key.endsWith('_criteria')) {
                    const fieldDiv = document.createElement('div');
                    fieldDiv.className = 'field-item';
                    
                    let content = review[key];
                    if (Array.isArray(content)) {
                        content = content.map(item => `<li>${item}</li>`).join('');
                        content = `<ul>${content}</ul>`;
                    } else if (key === 'Decision') {
                        const decisionClass = content === 'Accept' ? 'decision-accept' : 'decision-reject';
                        content = `<span class="${decisionClass}">${content}</span>`;
                    }
                    
                    fieldDiv.innerHTML = `
                        <strong>${key.replace(/_/g, ' ')}:</strong>
                        <div class="mt-2">${content}</div>
                    `;
                    otherFieldsContainer.appendChild(fieldDiv);
                }
            });

            // Show results section
            document.getElementById('resultSection').style.display = 'block';
            document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html> 